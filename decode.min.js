SmallHash={decode:function(e,t,n){e=bigInt.str2bigInt(e,n.length,n);var r=bigInt.dup(e),i=[];for(var s=0,o=t.length;s<o;s+=1)bigInt.divide(e,bigInt.int2bigInt(t[s],32),e,r),i[s]=Number(bigInt.bigInt2str(r,10,"0123456789"));return i},decodeUrl:function(e,t){var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-_",r=[[5,501,501,501,501,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[5,501,501,501,501,16,16,16,16,16,16,16,16,11,16,16,121,16,16,16,16,16,2,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16],[5,501,501,501,501,16,16,16,16,16,16,16,16,11,121,55,16,16,16,16,16,16,11,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,2,16,16,16,16],[5,501,501,501,501,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]],s=[{Eviscerate:5,Howl:13,Raze:26,Wolfstrike:8,"Battle Rage":30,Rupture:17,Ravage:33,"Blood Hunger":15,Executioner:22,Rampage:21,"Frost Breath":9,Stormclaw:23,"Storm Hatchet":6,"Northern Rage":10,Iceshield:31,Permafrost:28,"Glacial Shatter":34,"Cold Steel Mastery":19,"Shatter Storm":25,"Rage Retaliation":14,"Shadow Burst":7,"Wolf Shade":11,Shadowbind:20,"Savage Rush":27,"Chain Snare":32,"Battle Standard":29,Wolfpack:12,"Frenzy Mastery":16,"Shred Armor":24,"Red Wolf":18},{"Magma Spear":17,"Magma Mace":9,Firebombs:6,"Blazing Pillar":15,"Infernal Collapse":21,"Immolation Aura":8,Firestorm:34,"Charge Mastery":27,"Elemental Attunement":30,"Fire Brand":26,"Icy Blast":12,Hailstorm:7,"Frost Phase":18,"Elemental Boon":36,"Frost Wave":20,"Ice Prison":35,"Astral Ally":31,"Staff Mastery":28,"Frozen Fate":32,"Ice Brand":25,"Prismatic Bolt":11,"Shocking Burst":14,"Thunder Locus":19,"Arc Beam":10,"Death's Bounty":5,Shockbolts:33,"Shocking Orb":37,"Prismatic Rift":29,"Wand Chaos":23,"Lightning Brand":24},{"Flame Hammer":38,"Seismic Slam":40,"Ember Hammer":6,Onslaught:10,"Ember Reach":5,"Storm Burst":47,Emberquake:7,"Heavy Lifting":27,Supercharge:39,"Coup de Grace":19,"Healing Bot":17,"Blast Cannon":41,"Spider Mines":33,"Gun Bot":16,"Shock Grenade":35,Fusillade:37,Sledgebot:45,Bulwark:32,"Fire and Spark":24,"Charge Domination":28,"Shield Bash":36,Forcefield:34,Overload:9,"Dynamo Field":8,Tremor:44,"Fire Bash":42,"Immobilization Copter":46,"Sword and Board":25,"Aegis of Fate":21,"Charge Reconstitution":26},{"Rapid Fire":28,"Rune Vault":7,"Chaos Burst":9,"Cursed Daggers":5,"Vortex Hex":37,"Shattering Glaive":32,"Venomous Hail":38,"Long Range Mastery":22,"Shotgonne Mastery":19,Akimbo:23,"Glaive Throw":14,"Tangling Shot":29,"Glaive Sweep":12,Sandstorm:15,"Bramble Wall":36,"Burning Leap":6,"Flaming Glaives":31,"Dodge Mastery":16,"Poison Burst":17,"Share the Wealth":27,"Blade Pact":10,Shadowshot:13,"Bane Breath":8,"Repulsion Hex":30,"Stone Pact":11,Shadowmantle:33,"Shadowling Brute":35,"Master of the Elements":20,"Shadowling Ammo":25,"Death Ritual":26}],o=["berserker","embermage","engineer","outlander"],u=[["Hunter","Tundra","Shadow"],["Inferno","Frost","Storm"],["Blitz","Construction","Aegis"],["Warfare","Lore","Sigil"]];if(typeof e=="string"){toonClass=(Number(e.split("#")[0].slice(-1))-1)%4,tidbiUrl="",resu=SmallHash.decode(e.split("#")[1],r[toonClass],n),t==1&&console.log("Str:"+resu[1]+"/Dex:"+resu[2]+"/Foc:"+resu[3]+"/Vit:"+resu[4]),sumTiers=[0,0,0],j=0;for(i in s[toonClass])tidbiUrl+=resu[s[toonClass][i]].toString(16).toUpperCase(),j%10==0&&t==1&&console.log("\n"+u[toonClass][j/10].toUpperCase()),resu[s[toonClass][i]]>0&&(t==1&&console.log(i+": "+resu[s[toonClass][i]]),sumTiers[Math.floor(j/10)]+=resu[s[toonClass][i]]),j++;t==1&&console.log("\n"+sumTiers[0]+"/"+sumTiers[1]+"/"+sumTiers[2]),sum=sumTiers[0]+sumTiers[1]+sumTiers[2],sum<=100?tidbiUrl="http://tidbi.ru/eng/"+o[toonClass]+".php?lvl="+sum+"&fm=0&skill="+tidbiUrl:tidbiUrl="http://tidbi.ru/eng/"+o[toonClass]+".php?lvl=100&fm="+Math.min(sum-100,32)+"&skill="+tidbiUrl,tidbiUrl+="&stat=";for(i=1;i<5;i++)tidbiUrl+=n[Math.floor(resu[i]/52)]+n[resu[i]%52];return tidbiUrl+="aaaaaaaa",tidbiUrl}document.body.innerHTML=document.body.innerHTML.replace(/https*(:\/\/web.archive.org\/[0-9a-z\/]*|):\/\/torchlight2armory.com\/skill-calc\?i=[#a-z0-9_\-]*/ig,SmallHash.decodeUrl)}};var bigInt=function(){var e=0,t=0,n=t+1;for(e=0;1<<e+1>1<<e;e++);e>>=1,t=(1<<e)-1,n=t+1;var r=new Array(0),s=r,o=r,u=function(t){return t[t.length-1]>>e-1&1},a=function(e,t,n){var r=e.length,s=t.length;k=r+n<s?r+n:s;for(i=s-1-n;i<r&&i>=0;i++)if(e[i]>0)return 1;for(i=r-1+n;i<s;i++)if(t[i]>0)return 0;for(i=k-1;i>=n;i--){if(e[i-n]>t[i])return 1;if(e[i-n]<t[i])return 0}return 0},f=function(r,i,s,o){var f,l,c,h,p,d,g,w,E;v(o,r);for(l=i.length;i[l-1]==0;l--);E=i[l-1];for(w=0;E;w++)E>>=1;w=e-w,b(i,w),b(o,w);for(f=o.length;o[f-1]==0&&f>l;f--);m(s,0);while(!a(i,o,f-l))T(o,i,f-l),s[f-l]++;for(c=f-1;c>=l;c--){o[c]==i[l-1]?s[c-l]=t:s[c-l]=Math.floor((o[c]*n+o[c-1])/i[l-1]);for(;;){d=(l>1?i[l-2]:0)*s[c-l],g=d>>e,d&=t,p=g+s[c-l]*i[l-1],g=p>>e,p&=t;if(!(g==o[c]?p==o[c-1]?d>(c>1?o[c-2]:0):p>o[c-1]:g>o[c]))break;s[c-l]--}S(o,i,-s[c-l],c-l),u(o)&&(x(o,i,c-l),s[c-l]--)}y(i,w),y(o,w)},l=function(t,n,r){var i,s;return s=Math.ceil(n/e)+1,s=r>s?r:s,buff=new Array(s),m(buff,t),buff},c=function(e,t,n,r){var i,s,o,u,a,f,c=e.length;if(t==-1){u=new Array(0);for(;;){a=new Array(u.length+1);for(s=0;s<u.length;s++)a[s+1]=u[s];a[0]=parseInt(e,10),u=a,i=e.indexOf(",",0);if(i<1)break;e=e.substring(i+1);if(e.length==0)break}return u.length<r?(a=new Array(r),v(a,u),a):u}u=l(0,t*c,0);for(s=0;s<c;s++)i=n.indexOf(e.substring(s,s+1),0),t<=36&&i>=36&&(i-=26),i<t&&i>=0&&(w(u,t),g(u,i));for(c=u.length;c>0&&!u[c-1];c--);c=r>c+1?r:c+1,a=new Array(c),f=c<u.length?c:u.length;for(s=0;s<f;s++)a[s]=u[s];for(;s<c;s++)a[s]=0;return a},h=function(e){var t;for(t=0;t<e.length;t++)if(e[t])return 0;return 1},p=function(e,t,n){var r,i,s="";o.length!=e.length?o=d(e):v(o,e);if(t==-1){for(r=e.length-1;r>0;r--)s+=e[r]+",";s+=e[0]}else while(!h(o))i=E(o,t),s=n.substring(i,i+1)+s;return s.length==0&&(s=""),s},d=function(e){var t;return buff=new Array(e.length),v(buff,e),buff},v=function(e,t){var n,r=e.length<t.length?e.length:t.length;for(n=0;n<r;n++)e[n]=t[n];for(n=r;n<e.length;n++)e[n]=0},m=function(n,r){var i,s;for(s=r,i=0;i<n.length;i++)n[i]=s&t,s>>=e},g=function(r,i){var s,o,u,a;r[0]+=i,o=r.length,u=0;for(s=0;s<o;s++){u+=r[s],a=0,u<0&&(a=-(u>>e),u+=a*n),r[s]=u&t,u=(u>>e)-a;if(!u)return}},y=function(n,r){var i,s=Math.floor(r/e);if(s){for(i=0;i<n.length-s;i++)n[i]=n[i+s];for(;i<n.length;i++)n[i]=0;r%=e}for(i=0;i<n.length-1;i++)n[i]=t&(n[i+1]<<e-r|n[i]>>r);n[i]>>=r},b=function(n,r){var i,s=Math.floor(r/e);if(s){for(i=n.length;i>=s;i--)n[i]=n[i-s];for(;i>=0;i--)n[i]=0;r%=e}if(!r)return;for(i=n.length-1;i>0;i--)n[i]=t&(n[i]<<r|n[i-1]>>e-r);n[i]=t&n[i]<<r},w=function(r,i){var s,o,u,a;if(!i)return;o=r.length,u=0;for(s=0;s<o;s++)u+=r[s]*i,a=0,u<0&&(a=-(u>>e),u+=a*n),r[s]=u&t,u=(u>>e)-a},E=function(e,t){var r,i=0,s;for(r=e.length-1;r>=0;r--)s=i*n+e[r],e[r]=Math.floor(s/t),i=s%t;return i},S=function(n,r,i,s){var o,u,a,f;a=n.length<s+r.length?n.length:s+r.length,f=n.length;for(u=0,o=s;o<a;o++)u+=n[o]+i*r[o-s],n[o]=u&t,u>>=e;for(o=a;u&&o<f;o++)u+=n[o],n[o]=u&t,u>>=e},x=function(n,r,i){var s,o,u,a;u=n.length<i+r.length?n.length:i+r.length,a=n.length;for(o=0,s=i;s<u;s++)o+=n[s]+r[s-i],n[s]=o&t,o>>=e;for(s=u;o&&s<a;s++)o+=n[s],n[s]=o&t,o>>=e},T=function(n,r,i){var s,o,u,a;u=n.length<i+r.length?n.length:i+r.length,a=n.length;for(o=0,s=i;s<u;s++)o+=n[s]-r[s-i],n[s]=o&t,o>>=e;for(s=u;o&&s<a;s++)o+=n[s],n[s]=o&t,o>>=e},N=function(n,r){var i,s,o,u;o=n.length<r.length?n.length:r.length;for(s=0,i=0;i<o;i++)s+=n[i]-r[i],n[i]=s&t,s>>=e;for(i=o;s&&i<n.length;i++)s+=n[i],n[i]=s&t,s>>=e},C=function(n,r){var i,s,o,u;o=n.length<r.length?n.length:r.length;for(s=0,i=0;i<o;i++)s+=n[i]+r[i],n[i]=s&t,s>>=e;for(i=o;s&&i<n.length;i++)s+=n[i],n[i]=s&t,s>>=e},L=function(e,t){var n;s.length!=2*e.length&&(s=new Array(2*e.length)),m(s,0);for(n=0;n<t.length;n++)t[n]&&S(s,e,t[n],n);v(e,s)};return{int2bigInt:l,mult:L,add:C,divide:f,bigInt2str:p,str2bigInt:c,dup:d}}();window.onload=SmallHash.decodeUrl,document.readyState=="complete"&&SmallHash.decodeUrl();